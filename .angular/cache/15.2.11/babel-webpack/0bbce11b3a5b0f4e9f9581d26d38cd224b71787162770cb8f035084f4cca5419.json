{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport let FavoritesService = /*#__PURE__*/(() => {\n  class FavoritesService {\n    constructor() {\n      this.favoritesKey = 'star';\n      this.favoritesSubject = new BehaviorSubject(this.getFavoriteIds());\n      // Listen for storage changes (cross-tab sync)\n      window.addEventListener('storage', () => {\n        this.favoritesSubject.next(this.getFavoriteIds());\n      });\n      // Listen for custom events (same-tab updates)\n      document.addEventListener('favoritesUpdated', () => {\n        this.favoritesSubject.next(this.getFavoriteIds());\n      });\n    }\n    /**\n     * Get all favorite IDs\n     */\n    getFavoriteIds() {\n      try {\n        const favorites = localStorage.getItem(this.favoritesKey);\n        if (!favorites) return [];\n        const favoriteItems = JSON.parse(favorites);\n        return favoriteItems.map(item => item._id);\n      } catch (_a) {\n        return [];\n      }\n    }\n    /**\n     * Get all favorite items\n     */\n    getFavorites() {\n      try {\n        const favorites = localStorage.getItem(this.favoritesKey);\n        if (!favorites) return [];\n        return JSON.parse(favorites);\n      } catch (_a) {\n        return [];\n      }\n    }\n    /**\n     * Check if a product is favorited\n     */\n    isFavorite(productId) {\n      return this.getFavoriteIds().includes(productId);\n    }\n    /**\n     * Add product to favorites\n     */\n    addToFavorites(product) {\n      const favorites = this.getFavorites();\n      if (this.isFavorite(product._id)) {\n        return; // Already favorited\n      }\n\n      favorites.push(Object.assign(Object.assign({}, product), {\n        quantity: 1\n      }));\n      localStorage.setItem(this.favoritesKey, JSON.stringify(favorites));\n      this.favoritesSubject.next(this.getFavoriteIds());\n      document.dispatchEvent(new CustomEvent('favoritesUpdated'));\n    }\n    /**\n     * Remove product from favorites\n     */\n    removeFromFavorites(productId) {\n      const favorites = this.getFavorites();\n      const filtered = favorites.filter(item => item._id !== productId);\n      localStorage.setItem(this.favoritesKey, JSON.stringify(filtered));\n      this.favoritesSubject.next(this.getFavoriteIds());\n      document.dispatchEvent(new CustomEvent('favoritesUpdated'));\n    }\n    /**\n     * Toggle favorite status\n     */\n    toggleFavorite(product) {\n      if (this.isFavorite(product._id)) {\n        this.removeFromFavorites(product._id);\n        return false;\n      } else {\n        this.addToFavorites(product);\n        return true;\n      }\n    }\n    /**\n     * Get favorites count\n     */\n    getCount() {\n      return this.getFavoriteIds().length;\n    }\n    /**\n     * Get favorites as observable\n     */\n    getFavoritesObservable() {\n      return this.favoritesSubject.asObservable();\n    }\n  }\n  FavoritesService.ɵfac = function FavoritesService_Factory(t) {\n    return new (t || FavoritesService)();\n  };\n  FavoritesService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: FavoritesService,\n    factory: FavoritesService.ɵfac,\n    providedIn: 'root'\n  });\n  return FavoritesService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}