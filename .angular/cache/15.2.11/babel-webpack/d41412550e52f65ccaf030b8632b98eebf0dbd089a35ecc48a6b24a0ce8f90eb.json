{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport let CartService = /*#__PURE__*/(() => {\n  class CartService {\n    constructor() {\n      this.cartKey = 'cart';\n      this.cartItemsSubject = new BehaviorSubject(this.getCartFromStorage());\n      // Initialize cart from localStorage\n      this.updateCartSubject();\n    }\n    /**\n     * Get cart items from localStorage\n     */\n    getCartFromStorage() {\n      try {\n        const cart = localStorage.getItem(this.cartKey);\n        return cart ? JSON.parse(cart) : [];\n      } catch (error) {\n        console.error('Error reading cart from storage:', error);\n        return [];\n      }\n    }\n    /**\n     * Get cart items as observable\n     */\n    getCartItems() {\n      return this.cartItemsSubject.asObservable();\n    }\n    /**\n     * Get cart items synchronously\n     */\n    getCart() {\n      return this.getCartFromStorage();\n    }\n    /**\n     * Add item to cart\n     */\n    addItem(item) {\n      const cart = this.getCartFromStorage();\n      const existingItemIndex = cart.findIndex(cartItem => cartItem._id === item._id && cartItem.selectedSize === item.selectedSize);\n      if (existingItemIndex !== -1) {\n        // Update quantity if item already exists\n        cart[existingItemIndex].quantity += item.quantity || 1;\n      } else {\n        // Add new item\n        cart.push(Object.assign(Object.assign({}, item), {\n          quantity: item.quantity || 1\n        }));\n      }\n      this.saveCartToStorage(cart);\n      this.updateCartSubject();\n    }\n    /**\n     * Update item quantity in cart\n     */\n    updateQuantity(itemId, size, quantity) {\n      if (quantity < 1) return;\n      const cart = this.getCartFromStorage();\n      const itemIndex = cart.findIndex(item => item._id === itemId && item.selectedSize === size);\n      if (itemIndex !== -1) {\n        cart[itemIndex].quantity = quantity;\n        this.saveCartToStorage(cart);\n        this.updateCartSubject();\n      }\n    }\n    /**\n     * Remove item from cart\n     */\n    removeItem(itemId, size) {\n      const cart = this.getCartFromStorage();\n      const filteredCart = cart.filter(item => !(item._id === itemId && item.selectedSize === size));\n      this.saveCartToStorage(filteredCart);\n      this.updateCartSubject();\n    }\n    /**\n     * Clear all items from cart\n     */\n    clearCart() {\n      localStorage.removeItem(this.cartKey);\n      this.updateCartSubject();\n    }\n    /**\n     * Calculate subtotal (sum of all item prices × quantities)\n     */\n    getSubtotal() {\n      const cart = this.getCartFromStorage();\n      return cart.reduce((total, item) => {\n        return total + item.price * item.quantity;\n      }, 0);\n    }\n    /**\n     * Calculate VAT (14% of subtotal)\n     */\n    getVAT() {\n      const subtotal = this.getSubtotal();\n      return subtotal * 0.14; // 14% VAT\n    }\n    /**\n     * Calculate total (subtotal + VAT)\n     */\n    getTotal() {\n      return this.getSubtotal() + this.getVAT();\n    }\n    /**\n     * Get cart item count\n     */\n    getItemCount() {\n      return this.getCartFromStorage().length;\n    }\n    /**\n     * Save cart to localStorage\n     */\n    saveCartToStorage(cart) {\n      try {\n        localStorage.setItem(this.cartKey, JSON.stringify(cart));\n      } catch (error) {\n        console.error('Error saving cart to storage:', error);\n      }\n    }\n    /**\n     * Update cart subject\n     */\n    updateCartSubject() {\n      this.cartItemsSubject.next(this.getCartFromStorage());\n    }\n    // Legacy methods for backward compatibility\n    addProductToCart(product) {\n      this.addItem(product);\n    }\n    getCartItemss() {\n      return this.getCart();\n    }\n    addToCart(item) {\n      this.addItem(item);\n    }\n  }\n  CartService.ɵfac = function CartService_Factory(t) {\n    return new (t || CartService)();\n  };\n  CartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: CartService,\n    factory: CartService.ɵfac,\n    providedIn: 'root'\n  });\n  return CartService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}