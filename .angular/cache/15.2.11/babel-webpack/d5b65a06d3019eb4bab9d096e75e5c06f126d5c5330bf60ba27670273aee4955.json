{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nlet ContactFormsComponent = class ContactFormsComponent {\n  constructor(apiService, notificationService) {\n    this.apiService = apiService;\n    this.notificationService = notificationService;\n    this.contactForms = [];\n    this.currentPage = 1;\n    this.itemsPerPage = 10;\n    this.totalItems = 0;\n    this.totalPages = 0;\n    this.searchTerm = '';\n    this.sortBy = 'createdAt';\n    this.sortOrder = 'desc';\n    this.isLoading = false;\n    this.showViewModal = false;\n    this.selectedForm = null;\n    this.filterReplied = '';\n    this.searchTimeout = null;\n    this.Math = Math;\n  }\n  ngOnInit() {\n    this.loadContactForms();\n  }\n  ngOnDestroy() {\n    if (this.searchTimeout) {\n      clearTimeout(this.searchTimeout);\n    }\n  }\n  loadContactForms() {\n    this.isLoading = true;\n    const params = {\n      page: this.currentPage,\n      limit: this.itemsPerPage,\n      sort: `${this.sortOrder === 'desc' ? '-' : ''}${this.sortBy}`,\n      keyword: this.searchTerm || undefined\n    };\n    this.apiService.getPaginated('/submit', params).subscribe({\n      next: response => {\n        let forms = response.data || [];\n        if (this.filterReplied === 'replied') {\n          forms = forms.filter(form => form.isReplied);\n        } else if (this.filterReplied === 'unreplied') {\n          forms = forms.filter(form => !form.isReplied);\n        }\n        this.contactForms = forms;\n        if (response.pagination) {\n          this.totalItems = response.pagination.totalItems || 0;\n          this.totalPages = response.pagination.totalPages || 0;\n          if (response.pagination.itemsPerPage) {\n            this.itemsPerPage = response.pagination.itemsPerPage;\n          }\n        } else {\n          const formsLength = this.contactForms.length;\n          this.totalItems = formsLength;\n          this.totalPages = formsLength > 0 ? Math.max(1, Math.ceil(formsLength / this.itemsPerPage)) : 0;\n        }\n        this.isLoading = false;\n      },\n      error: error => {\n        console.error('Error loading contact forms:', error);\n        this.isLoading = false;\n        this.totalPages = 0;\n        this.totalItems = 0;\n        this.notificationService.error('Error', 'Failed to load contact messages');\n      }\n    });\n  }\n  onSearch() {\n    this.currentPage = 1;\n    this.loadContactForms();\n  }\n  onSearchInput() {\n    if (this.searchTimeout) {\n      clearTimeout(this.searchTimeout);\n    }\n    this.searchTimeout = setTimeout(() => {\n      this.currentPage = 1;\n      this.loadContactForms();\n    }, 500);\n  }\n  onSort(field) {\n    if (this.sortBy === field) {\n      this.sortOrder = this.sortOrder === 'asc' ? 'desc' : 'asc';\n    } else {\n      this.sortBy = field;\n      this.sortOrder = 'desc';\n    }\n    this.loadContactForms();\n  }\n  onFilter() {\n    this.currentPage = 1;\n    this.loadContactForms();\n  }\n  goToPage(page) {\n    if (page >= 1 && page <= this.totalPages) {\n      this.currentPage = page;\n      this.loadContactForms();\n    }\n  }\n  showViewMessageModal(form) {\n    this.selectedForm = form;\n    this.showViewModal = true;\n    document.body.classList.add('modal-open');\n  }\n  closeModals() {\n    this.showViewModal = false;\n    this.selectedForm = null;\n    document.body.classList.remove('modal-open');\n  }\n  getMessagePreview(message, maxLength = 50) {\n    if (!message) return '';\n    if (message.length <= maxLength) return message;\n    return message.substring(0, maxLength) + '...';\n  }\n  get filteredContactForms() {\n    return this.contactForms;\n  }\n  get pageNumbers() {\n    if (!this.totalPages || this.totalPages <= 0) {\n      return [];\n    }\n    return Array.from({\n      length: this.totalPages\n    }, (_, i) => i + 1);\n  }\n};\nContactFormsComponent = __decorate([Component({\n  selector: 'app-contact-forms',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  templateUrl: './contact-forms.component.html',\n  styleUrls: ['./contact-forms.component.css']\n})], ContactFormsComponent);\nexport { ContactFormsComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}