{"ast":null,"code":"import { Validators, ReactiveFormsModule } from '@angular/forms';\nimport { FormsModule } from '@angular/forms';\nimport { CommonModule } from '@angular/common';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/api.service\";\nimport * as i2 from \"../../services/notification.service\";\nimport * as i3 from \"@angular/forms\";\nexport let CategoriesComponent = /*#__PURE__*/(() => {\n  class CategoriesComponent {\n    constructor(apiService, notificationService, fb) {\n      this.apiService = apiService;\n      this.notificationService = notificationService;\n      this.fb = fb;\n      this.categories = [];\n      this.currentPage = 1;\n      this.itemsPerPage = 10;\n      this.totalItems = 0;\n      this.totalPages = 0;\n      this.searchTerm = '';\n      this.sortBy = 'createdAt';\n      this.sortOrder = 'desc';\n      this.isLoading = false;\n      this.showAddModal = false;\n      this.showEditModal = false;\n      this.showDeleteModal = false;\n      this.selectedCategory = null;\n      this.selectedImage = null;\n      this.selectedEditImage = null;\n      this.uploadsBaseUrl = environment.apiUrl.replace('/api/v1', '') + '/uploads';\n      this.Math = Math;\n      this.categoryForm = this.fb.group({\n        name: ['', [Validators.required, Validators.minLength(3)]]\n      });\n      this.editCategoryForm = this.fb.group({\n        name: ['', [Validators.required, Validators.minLength(3)]]\n      });\n    }\n    ngOnInit() {\n      this.loadCategories();\n    }\n    loadCategories() {\n      this.isLoading = true;\n      const params = {\n        page: this.currentPage,\n        limit: this.itemsPerPage,\n        sort: `${this.sortOrder === 'desc' ? '-' : ''}${this.sortBy}`,\n        keyword: this.searchTerm || undefined\n      };\n      this.apiService.getPaginated('/categories', params).subscribe({\n        next: response => {\n          var _a;\n          this.categories = response.data || [];\n          this.totalItems = response.results || 0;\n          this.totalPages = ((_a = response.pagination) === null || _a === void 0 ? void 0 : _a.numberOfPages) || 0;\n          this.isLoading = false;\n        },\n        error: error => {\n          console.error('Error loading categories:', error);\n          this.isLoading = false;\n          this.notificationService.error('Error', 'Failed to load categories');\n        }\n      });\n    }\n    onSearch() {\n      this.currentPage = 1;\n      this.loadCategories();\n    }\n    onSort(field) {\n      if (this.sortBy === field) {\n        this.sortOrder = this.sortOrder === 'asc' ? 'desc' : 'asc';\n      } else {\n        this.sortBy = field;\n        this.sortOrder = 'desc';\n      }\n      this.loadCategories();\n    }\n    goToPage(page) {\n      if (page >= 1 && page <= this.totalPages) {\n        this.currentPage = page;\n        this.loadCategories();\n      }\n    }\n    showAddCategoryModal() {\n      this.categoryForm.reset();\n      this.selectedImage = null;\n      this.showAddModal = true;\n    }\n    showEditCategoryModal(category) {\n      this.selectedCategory = category;\n      this.editCategoryForm.patchValue({\n        name: category.name\n      });\n      this.selectedEditImage = null;\n      this.showEditModal = true;\n    }\n    showDeleteCategoryModal(category) {\n      this.selectedCategory = category;\n      this.showDeleteModal = true;\n    }\n    addCategory() {\n      if (this.categoryForm.valid && this.selectedImage) {\n        const formData = new FormData();\n        formData.append('name', this.categoryForm.value.name);\n        formData.append('image', this.selectedImage);\n        this.apiService.postFormData('/categories', formData).subscribe({\n          next: response => {\n            this.notificationService.success('Success', 'Category added successfully');\n            this.showAddModal = false;\n            this.loadCategories();\n          },\n          error: error => {\n            var _a;\n            console.error('Error adding category:', error);\n            this.notificationService.error('Error', ((_a = error.error) === null || _a === void 0 ? void 0 : _a.message) || 'Failed to add category');\n          }\n        });\n      }\n    }\n    updateCategory() {\n      if (this.editCategoryForm.valid && this.selectedCategory) {\n        const formData = new FormData();\n        formData.append('name', this.editCategoryForm.value.name);\n        if (this.selectedEditImage) {\n          formData.append('image', this.selectedEditImage);\n        }\n        this.apiService.putFormData('/categories', this.selectedCategory._id, formData).subscribe({\n          next: response => {\n            this.notificationService.success('Success', 'Category updated successfully');\n            this.showEditModal = false;\n            this.loadCategories();\n          },\n          error: error => {\n            var _a;\n            console.error('Error updating category:', error);\n            this.notificationService.error('Error', ((_a = error.error) === null || _a === void 0 ? void 0 : _a.message) || 'Failed to update category');\n          }\n        });\n      }\n    }\n    deleteCategory() {\n      if (this.selectedCategory) {\n        this.apiService.delete('/categories', this.selectedCategory._id).subscribe({\n          next: response => {\n            this.notificationService.success('Success', 'Category deleted successfully');\n            this.showDeleteModal = false;\n            this.loadCategories();\n          },\n          error: error => {\n            var _a;\n            console.error('Error deleting category:', error);\n            this.notificationService.error('Error', ((_a = error.error) === null || _a === void 0 ? void 0 : _a.message) || 'Failed to delete category');\n          }\n        });\n      }\n    }\n    onImageSelected(event, isEdit = false) {\n      const file = event.target.files[0];\n      if (file) {\n        if (isEdit) {\n          this.selectedEditImage = file;\n        } else {\n          this.selectedImage = file;\n        }\n      }\n    }\n    closeModals() {\n      this.showAddModal = false;\n      this.showEditModal = false;\n      this.showDeleteModal = false;\n      this.selectedCategory = null;\n    }\n    getImageUrl(imagePath) {\n      if (imagePath.startsWith('http')) {\n        return imagePath;\n      }\n      return `${this.uploadsBaseUrl}/category/${imagePath}`;\n    }\n    get filteredCategories() {\n      return this.categories;\n    }\n    /**\n     * Get form field error message\n     */\n    getFieldError(formGroup, fieldName) {\n      var _a, _b;\n      const control = formGroup.get(fieldName);\n      if (control && control.invalid && (control.dirty || control.touched)) {\n        if ((_a = control.errors) === null || _a === void 0 ? void 0 : _a['required']) {\n          return `${this.getFieldLabel(fieldName)} is required`;\n        }\n        if ((_b = control.errors) === null || _b === void 0 ? void 0 : _b['minlength']) {\n          const minLength = control.errors['minlength'].requiredLength;\n          return `${this.getFieldLabel(fieldName)} must be at least ${minLength} characters`;\n        }\n      }\n      return '';\n    }\n    /**\n     * Check if field has error\n     */\n    hasFieldError(formGroup, fieldName) {\n      const control = formGroup.get(fieldName);\n      return !!(control && control.invalid && (control.dirty || control.touched));\n    }\n    /**\n     * Get field label for error messages\n     */\n    getFieldLabel(fieldName) {\n      const labels = {\n        name: 'Category Name'\n      };\n      return labels[fieldName] || fieldName;\n    }\n  }\n  CategoriesComponent.ɵfac = function CategoriesComponent_Factory(t) {\n    return new (t || CategoriesComponent)(i0.ɵɵdirectiveInject(i1.ApiService), i0.ɵɵdirectiveInject(i2.NotificationService), i0.ɵɵdirectiveInject(i3.FormBuilder));\n  };\n  CategoriesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: CategoriesComponent,\n    selectors: [[\"app-categories\"]],\n    standalone: true,\n    features: [i0.ɵɵStandaloneFeature],\n    decls: 0,\n    vars: 0,\n    template: function CategoriesComponent_Template(rf, ctx) {},\n    dependencies: [CommonModule, FormsModule, ReactiveFormsModule],\n    styles: [\".categories-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f9fafb}@media (prefers-color-scheme: dark){.categories-container[_ngcontent-%COMP%]{background-color:#111827}}.category-card[_ngcontent-%COMP%]{transition:transform .2s ease-in-out,box-shadow .2s ease-in-out}.category-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.aspect-w-16[_ngcontent-%COMP%]{position:relative;padding-bottom:56.25%}.aspect-h-9[_ngcontent-%COMP%]{position:absolute;height:100%;width:100%;inset:0}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.animate-spin[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@media (min-width: 320px){.categories-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(1,1fr);gap:1rem}}@media (min-width: 640px){.categories-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:1.5rem}}@media (min-width: 1024px){.categories-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr);gap:1.5rem}}@media (min-width: 1280px){.categories-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(4,1fr);gap:1.5rem}}button[_ngcontent-%COMP%]:focus, a[_ngcontent-%COMP%]:focus, input[_ngcontent-%COMP%]:focus{outline:2px solid #3b82f6;outline-offset:2px}*[_ngcontent-%COMP%]{transition:background-color .3s ease,border-color .3s ease,color .3s ease}@media (max-width: 768px){button[_ngcontent-%COMP%], a[_ngcontent-%COMP%]{min-height:44px;min-width:44px}.touch-target[_ngcontent-%COMP%]{padding:.75rem}}.category-image[_ngcontent-%COMP%]{background-color:#f3f4f6;background-image:linear-gradient(45deg,#f3f4f6 25%,transparent 25%),linear-gradient(-45deg,#f3f4f6 25%,transparent 25%),linear-gradient(45deg,transparent 75%,#f3f4f6 75%),linear-gradient(-45deg,transparent 75%,#f3f4f6 75%);background-size:20px 20px;background-position:0 0,0 10px,10px -10px,-10px 0px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:3rem 1rem}.empty-state[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin:0 auto 1rem;color:#9ca3af}.modal-enter[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_modalEnter .3s ease-out}@keyframes _ngcontent-%COMP%_modalEnter{0%{opacity:0;transform:scale(.9)}to{opacity:1;transform:scale(1)}}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}.form-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:#374151;margin-bottom:.5rem}.form-input[_ngcontent-%COMP%]{width:100%;padding:.5rem .75rem;border:1px solid #d1d5db;border-radius:.375rem;background-color:#fff;color:#111827;font-size:.875rem}.form-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}@media (prefers-color-scheme: dark){.form-label[_ngcontent-%COMP%]{color:#d1d5db}.form-input[_ngcontent-%COMP%]{background-color:#374151;border-color:#4b5563;color:#f9fafb}.form-input[_ngcontent-%COMP%]:focus{border-color:#60a5fa;box-shadow:0 0 0 3px #60a5fa1a}}@media print{.category-card[_ngcontent-%COMP%]{-moz-column-break-inside:avoid;break-inside:avoid;page-break-inside:avoid}}\"]\n  });\n  return CategoriesComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}