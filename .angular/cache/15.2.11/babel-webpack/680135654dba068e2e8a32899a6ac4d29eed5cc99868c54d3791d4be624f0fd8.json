{"ast":null,"code":"import { EventEmitter, inject, ChangeDetectorRef } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { RouterModule } from '@angular/router';\nimport { FavoritesService } from '../../../services/favorites.service';\nimport { EnvironmentService } from '../../../services/environment.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"@angular/router\";\nfunction ProductCardComponent_img_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"img\", 16);\n    i0.ɵɵlistener(\"error\", function ProductCardComponent_img_3_Template_img_error_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.onImageError());\n    })(\"load\", function ProductCardComponent_img_3_Template_img_load_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.onImageLoad());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"src\", ctx_r0.imageUrl, i0.ɵɵsanitizeUrl)(\"alt\", ctx_r0.product.title);\n  }\n}\nfunction ProductCardComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 17);\n    i0.ɵɵelement(1, \"i\", 18);\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3, \"No image\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction ProductCardComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 19)(1, \"div\", 20)(2, \"span\", 21);\n    i0.ɵɵtext(3, \"Loading...\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction ProductCardComponent_span_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 22);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" -\", ctx_r3.discountPercentage, \"% \");\n  }\n}\nfunction ProductCardComponent_span_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 23);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"number\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(2, 1, ctx_r4.product.price, \"1.0-0\"), \" EGP \");\n  }\n}\nconst _c0 = function (a1) {\n  return [\"/product\", a1];\n};\nexport let ProductCardComponent = /*#__PURE__*/(() => {\n  class ProductCardComponent {\n    constructor() {\n      this.addToCartClick = new EventEmitter();\n      this.favoriteClick = new EventEmitter();\n      this.favoritesService = inject(FavoritesService);\n      this.env = inject(EnvironmentService);\n      this.cdr = inject(ChangeDetectorRef);\n      this.imagePlaceholder = 'assets/img/logo/amigo-logo.png';\n      this.isImageError = false;\n      this.isImageLoading = true;\n    }\n    get isFavorite() {\n      return this.favoritesService.isFavorite(this.product._id);\n    }\n    get imageUrl() {\n      if (!this.product.imageCover) {\n        return this.imagePlaceholder;\n      }\n      if (this.product.imageCover.startsWith('http://') || this.product.imageCover.startsWith('https://')) {\n        return this.product.imageCover;\n      }\n      return this.env.getImageUrl('products/' + this.product.imageCover);\n    }\n    get displayPrice() {\n      return this.product.priceAfterDiscount || this.product.price;\n    }\n    get hasDiscount() {\n      return !!this.product.priceAfterDiscount && this.product.priceAfterDiscount < this.product.price;\n    }\n    get discountPercentage() {\n      if (!this.hasDiscount) return 0;\n      return Math.round((this.product.price - this.product.priceAfterDiscount) / this.product.price * 100);\n    }\n    onImageError() {\n      this.isImageError = true;\n      this.isImageLoading = false;\n      this.cdr.markForCheck();\n    }\n    onImageLoad() {\n      this.isImageLoading = false;\n      this.cdr.markForCheck();\n    }\n    onAddToCart(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      this.addToCartClick.emit(this.product);\n    }\n    onFavoriteClick(event) {\n      event.preventDefault();\n      event.stopPropagation();\n      const wasAdded = this.favoritesService.toggleFavorite(this.product);\n      this.cdr.markForCheck();\n      this.favoriteClick.emit(this.product);\n    }\n    trackByProductId(index, product) {\n      return product._id;\n    }\n  }\n  ProductCardComponent.ɵfac = function ProductCardComponent_Factory(t) {\n    return new (t || ProductCardComponent)();\n  };\n  ProductCardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductCardComponent,\n    selectors: [[\"app-product-card\"]],\n    inputs: {\n      product: \"product\"\n    },\n    outputs: {\n      addToCartClick: \"addToCartClick\",\n      favoriteClick: \"favoriteClick\"\n    },\n    standalone: true,\n    features: [i0.ɵɵStandaloneFeature],\n    decls: 21,\n    vars: 20,\n    consts: [[1, \"product-card\"], [1, \"product-card-image-wrapper\"], [1, \"product-card-link\", 3, \"routerLink\"], [\"class\", \"product-card-image\", \"loading\", \"lazy\", 3, \"src\", \"alt\", \"error\", \"load\", 4, \"ngIf\"], [\"class\", \"product-card-placeholder\", 4, \"ngIf\"], [\"class\", \"product-card-overlay\", 4, \"ngIf\"], [\"class\", \"product-card-discount-badge\", 4, \"ngIf\"], [\"type\", \"button\", \"aria-label\", \"Toggle favorite\", 1, \"product-card-favorite-btn\", 3, \"click\"], [1, \"product-card-body\"], [1, \"product-card-title\"], [3, \"routerLink\"], [1, \"product-card-price\"], [1, \"price-current\"], [\"class\", \"price-original\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"product-card-cart-btn\", 3, \"click\"], [1, \"fas\", \"fa-shopping-cart\"], [\"loading\", \"lazy\", 1, \"product-card-image\", 3, \"src\", \"alt\", \"error\", \"load\"], [1, \"product-card-placeholder\"], [1, \"fas\", \"fa-image\"], [1, \"product-card-overlay\"], [\"role\", \"status\", 1, \"spinner-border\", \"spinner-border-sm\"], [1, \"visually-hidden\"], [1, \"product-card-discount-badge\"], [1, \"price-original\"]],\n    template: function ProductCardComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"a\", 2);\n        i0.ɵɵtemplate(3, ProductCardComponent_img_3_Template, 1, 2, \"img\", 3);\n        i0.ɵɵtemplate(4, ProductCardComponent_div_4_Template, 4, 0, \"div\", 4);\n        i0.ɵɵtemplate(5, ProductCardComponent_div_5_Template, 4, 0, \"div\", 5);\n        i0.ɵɵtemplate(6, ProductCardComponent_span_6_Template, 2, 1, \"span\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"button\", 7);\n        i0.ɵɵlistener(\"click\", function ProductCardComponent_Template_button_click_7_listener($event) {\n          return ctx.onFavoriteClick($event);\n        });\n        i0.ɵɵelement(8, \"i\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"div\", 8)(10, \"h3\", 9)(11, \"a\", 10);\n        i0.ɵɵtext(12);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(13, \"div\", 11)(14, \"span\", 12);\n        i0.ɵɵtext(15);\n        i0.ɵɵpipe(16, \"number\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(17, ProductCardComponent_span_17_Template, 3, 4, \"span\", 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"button\", 14);\n        i0.ɵɵlistener(\"click\", function ProductCardComponent_Template_button_click_18_listener($event) {\n          return ctx.onAddToCart($event);\n        });\n        i0.ɵɵelement(19, \"i\", 15);\n        i0.ɵɵtext(20, \" Add to Cart \");\n        i0.ɵɵelementEnd()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(16, _c0, ctx.product._id));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.isImageError);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isImageError);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.isImageLoading && !ctx.isImageError);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.hasDiscount);\n        i0.ɵɵadvance(1);\n        i0.ɵɵclassProp(\"active\", ctx.isFavorite);\n        i0.ɵɵadvance(1);\n        i0.ɵɵclassMap(ctx.isFavorite ? \"fas fa-heart\" : \"far fa-heart\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(18, _c0, ctx.product._id));\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.product.title);\n        i0.ɵɵadvance(3);\n        i0.ɵɵtextInterpolate1(\"\", i0.ɵɵpipeBind2(16, 13, ctx.displayPrice, \"1.0-0\"), \" EGP\");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.hasDiscount);\n      }\n    },\n    dependencies: [CommonModule, i1.NgIf, i1.DecimalPipe, RouterModule, i2.RouterLink],\n    styles: [\".product-card[_ngcontent-%COMP%]{background:white;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #00000014;transition:all .3s ease;height:100%;display:flex;flex-direction:column;position:relative}.product-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 16px #0000001f;transform:translateY(-2px)}.product-card-image-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;padding-top:75%;overflow:hidden;background-color:#f8f9fa}.product-card-link[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:block}.product-card-image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;position:absolute;top:0;left:0;transition:transform .3s ease}.product-card[_ngcontent-%COMP%]:hover   .product-card-image[_ngcontent-%COMP%]{transform:scale(1.05)}.product-card-placeholder[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;color:#6c757d;background-color:#f8f9fa}.product-card-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;margin-bottom:.5rem;opacity:.5}.product-card-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.875rem}.product-card-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;background-color:#fffc;z-index:1}.product-card-discount-badge[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;background:#dc3545;color:#fff;padding:4px 8px;border-radius:4px;font-size:.75rem;font-weight:700;z-index:2}.product-card-favorite-btn[_ngcontent-%COMP%]{position:absolute;top:8px;left:8px;background:white;border:none;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;z-index:2;box-shadow:0 2px 4px #0000001a}.product-card-favorite-btn[_ngcontent-%COMP%]:hover{background:#fff;transform:scale(1.1)}.product-card-favorite-btn.active[_ngcontent-%COMP%]{color:#dc3545}.product-card-favorite-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.product-card-body[_ngcontent-%COMP%]{padding:1rem;display:flex;flex-direction:column;flex-grow:1}.product-card-title[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1rem;font-weight:500;line-height:1.4;min-height:2.8rem;overflow:hidden;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}.product-card-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#212529;text-decoration:none;transition:color .2s ease}.product-card-title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.product-card-price[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.75rem;flex-grow:1}.price-current[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#dc3545}.price-original[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d;text-decoration:line-through}.product-card-cart-btn[_ngcontent-%COMP%]{width:100%;padding:.75rem;background:#007bff;color:#fff;border:none;border-radius:6px;font-weight:500;cursor:pointer;transition:all .2s ease;display:flex;align-items:center;justify-content:center;gap:.5rem}.product-card-cart-btn[_ngcontent-%COMP%]:hover{background:#0056b3;transform:translateY(-1px)}.product-card-cart-btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.product-card-cart-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:.875rem}@keyframes _ngcontent-%COMP%_heartBeat{0%,to{transform:scale(1)}50%{transform:scale(1.2)}}.product-card-favorite-btn.active[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_heartBeat .3s ease}@media (max-width: 576px){.product-card-body[_ngcontent-%COMP%]{padding:.75rem}.product-card-title[_ngcontent-%COMP%]{font-size:.9rem;min-height:2.5rem}.price-current[_ngcontent-%COMP%]{font-size:1.1rem}.product-card-cart-btn[_ngcontent-%COMP%]{padding:.625rem;font-size:.875rem}}\"],\n    changeDetection: 0\n  });\n  return ProductCardComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}